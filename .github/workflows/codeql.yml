name: CodeQL Analysis

on:
  push:
    branches:
      - main  # Adjust to the branch you want to trigger on

jobs:
  codeql-analysis:
    name: Run CodeQL Analysis
    runs-on: ubuntu-latest  # You can change the runner as needed

    strategy:
      matrix:
        language: ['javascript']  # Adjust to your project's primary language
        # Add more languages if needed

    steps:
      - name: Checkout code
        uses: actions/checkout@v2

      - name: Initialize CodeQL
        uses: github/codeql-action/init@v1
        with:
          languages: ${{ matrix.language }}
          paths-ignore: '**/*.!(conf)'  # Ignore all files except .conf files

      - name: Build CodeQL database
        run: codeql database create codeql-database --language=${{ matrix.language }}

      - name: Analyze code with CodeQL
        run: codeql database analyze codeql-database --language=${{ matrix.language }} ${{ github.workspace }}

      - name: Upload CodeQL results
        uses: github/codeql-action/upload-sarif@v1
        with:
          sarif_file: codeql-database/results/codeql-sarif.sarif
